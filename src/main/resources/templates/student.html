<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Management</title>
  <style>
    /* student.css */

    body {
      font-family: 'Arial', sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    h1 {
      color: #333;
    }

    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      margin: 20px 0;
      max-width: 400px;
    }

    label {
      display: block;
      margin-bottom: 5px;
      color: #333;
    }

    input {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
      box-sizing: border-box;
    }

    button {
      background-color: #4caf50;
      color: #fff;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #45a049;
    }

    ul {
      list-style-type: none;
      padding: 0;
      margin-top: 20px;
    }

    li {
      margin-bottom: 10px;
      padding: 10px;
      background-color: #fff;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
      border-radius: 4px;
    }

  </style>
</head>
<body>

<h1>Student Management</h1>

<!-- Add Student Form -->
<form id="addStudentForm">
  <label for="examNumber">Exam Number:</label>
  <input type="text" id="examNumber" required>

  <label for="studentName">Student Name:</label>
  <input type="text" id="studentName" required>

  <label for="grade">Grade:</label>
  <input type="text" id="grade" required>

  <button type="button" onclick="addStudent()">Add Student</button>
</form>

<!-- Update Student Form -->
<form id="updateStudentForm">
  <label for="updateExamNumber">Exam Number to Update:</label>
  <input type="text" id="updateExamNumber" required>

  <label for="updateStudentName">New Student Name:</label>
  <input type="text" id="updateStudentName" required>

  <label for="updateGrade">New Grade:</label>
  <input type="text" id="updateGrade" required>

  <button type="button" onclick="updateStudent()">Update Student</button>
</form>

<!-- Delete Student Form -->
<form id="deleteStudentForm">
  <label for="deleteExamNumber">Exam Number to Delete:</label>
  <input type="text" id="deleteExamNumber" required>

  <button type="button" onclick="deleteStudent()">Delete Student</button>
</form>

<!-- Fetch All Students Button -->
<button onclick="fetchAllStudents()">Fetch All Students</button>

<!-- Student List -->
<ul id="studentList"></ul>
<script>
  // student.js

  function addStudent() {
    const examNumber = document.getElementById('examNumber').value;
    const studentName = document.getElementById('studentName').value;
    const grade = document.getElementById('grade').value;

    const student = {
      examNumber: parseInt(examNumber),
      studentName: studentName,
      grade: grade
    };

    fetch('http://localhost:8089/acstudents/students/add', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(student),
    })
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.json();
            })
            .then(data => {
              console.log('Student added:', data);
            })
            .catch(error => {
              console.error('Error adding student:', error);

              // 输出服务器返回的错误信息
              if (error.response && error.response.status === 500) {
                error.response.json().then(errorData => {
                  console.error('Server error:', errorData);
                });
              }
            });
  }


  function updateStudent() {
    const updateExamNumber = document.getElementById('updateExamNumber').value;
    const updateStudentName = document.getElementById('updateStudentName').value;
    const updateGrade = document.getElementById('updateGrade').value;

    const updatedStudent = {
      examNumber: parseInt(updateExamNumber),
      studentName: updateStudentName,
      grade: updateGrade
    };

    fetch('http://localhost:8089/acstudents/students/update', { // 更新这里的路径
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(updatedStudent),
    })
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.json();
            })
            .then(data => {
              console.log('Student updated:', data);
            })
            .catch(error => {
              console.error('Error updating student:', error);
            });
  }

  function deleteStudent() {
    const deleteExamNumber = document.getElementById('deleteExamNumber').value;

    fetch(`http://localhost:8089/acstudents/students/delete/${deleteExamNumber}`, { // 更新这里的路径
      method: 'DELETE',
    })
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.json();
            })
            .then(data => {
              console.log('Student deleted:', data);
            })
            .catch(error => {
              console.error('Error deleting student:', error);
            });
  }

  function fetchAllStudents() {
    fetch('http://localhost:8089/acstudents/students/all') // 更新这里的路径
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.json();
            })
            .then(data => {
              displayStudents(data);
            })
            .catch(error => {
              console.error('Error fetching students:', error);
            });
  }

  function displayStudents(students) {
    const studentList = document.getElementById('studentList');
    studentList.innerHTML = '';

    students.forEach(student => {
      const listItem = document.createElement('li');
      listItem.textContent = `Exam Number: ${student.examNumber}, Student Name: ${student.studentName}, Grade: ${student.grade}`;
      studentList.appendChild(listItem);
    });
  }


</script>
</body>
</html>
